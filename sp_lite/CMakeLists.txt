cmake_minimum_required(VERSION 2.8)
SET(CMAKE_VERBOSE_MAKEFILE ON)

PROJECT(sp_lite C CXX)

FIND_PACKAGE(MPI)


IF (MPI_FOUND)
    INCLUDE_DIRECTORIES(${MPI_INCLUDE_PATH}) 
ENDIF (MPI_FOUND)

SET(HDF5_PREFER_PARALLEL ON)
SET(HDF5_USE_STATIC_LIBRARIES OFF)

FIND_PACKAGE(HDF5 1.8 COMPONENTS C HL)

IF (HDF5_FOUND)
    INCLUDE_DIRECTORIES(${HDF5_INCLUDE_DIRS})
    IF (HDF5_IS_PARALLEL)
        ADD_DEFINITIONS(-DUSE_PARALLEL_IO -DH5_HAVE_PARALLEL)
    ENDIF (HDF5_IS_PARALLEL)
ENDIF (HDF5_FOUND)

FIND_PACKAGE(CUDA 7.5 REQUIRED)

FILE(GLOB sp_lite_SRC ./*.c)
add_library(sp_lite ${sp_lite_SRC})

ADD_DEFINITIONS(-DUSE_CUDA -DENABLE_SOA -DNUMBER_OF_THREADS_PER_BLOCK=256)
SET(CUDA_NVCC_FLAGS -DENABLE_SOA --maxrregcount=32)
FILE(GLOB sp_boris_yee_SRC   ./*.cu)
CUDA_ADD_EXECUTABLE(sp_boris_yee ${sp_boris_yee_SRC})
TARGET_LINK_LIBRARIES(sp_boris_yee    sp_lite)

